<!DOCTYPE html>
<!--
    Copyright (C) 2015-2018 Sumandeep Banerjee
    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as published
    by the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.
    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.
    You should have received a copy of the GNU Affero General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
<!--
    Prometheus: Online Tutorial Portal
    Author: sumandeep.banerjee@gmail.com
-->
<div ng-controller="UserController">
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#!/">Prometheus</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li class="page-scroll" data-ng-show="!authentication.user">
                        <a href="/login">Login</a>
                    </li>
                    <li class="page-scroll" data-ng-show="!authentication.user">
                        <a href="/register">Register</a>
                    </li>
                    <li class="page-scroll" data-ng-show="authentication.user">
                        <a href="/#!/user">User</a>
                    </li>
                    <li class="page-scroll" data-ng-show="authentication.user && authentication.user.permission === 'admin'">
                        <a href="/#!/user/stats">Stats</a>
                    </li>
                    <li class="page-scroll" data-ng-show="authentication.user">
                        <a href="/logout">Hello <span data-ng-bind="authentication.user.username" data-ng-show="authentication.user"></span>, Logout?</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container-fluid -->
    </nav>

    <section class="success" data-ng-show="authentication.user && authentication.user.permission === 'admin'" data-ng-init="find()">
        <div class="container">
            <div>
                <span class="err" data-ng-show="errorMsg">{{errorMsg}}</span>
            </div>
            <h1>User List</h1>
            Show approved: <input type="checkbox" data-ng-model="showapproved" data-ng-init="showapproved = true">
            <table>
                <tr>
                    <th>Username</th>
                    <th>Email</th>
                    <th>Permission</th>
                    <th>Status</th>
                    <th>Operations</th>
                </tr>
                <tr data-ng-repeat="user in users" data-ng-if="showapproved && user.approved || !user.approved">
                    <td><a data-ng-bind="user.username"></a></td>
                    <td><a data-ng-bind="user.email"></a></td>
                    <td><a data-ng-bind="user.permission"></a></td>
                    <td><a data-ng-bind="user.approved ? 'approved' : 'not approved'"></a></td>
                    <td data-ng-show="authentication.user.username !== user.username">
                        <a class="btn btn-primary btn-sm" data-ng-show="user.approved" data-ng-click="update(user, false)"><span class="glyphicon glyphicon-thumbs-down"></span></a>
                        <a class="btn btn-primary btn-sm" data-ng-show="!user.approved" data-ng-click="update(user, true)"><span class="glyphicon glyphicon-thumbs-up"></span></a>
                        <a class="btn btn-primary btn-sm" data-ng-click="delete(user)"><span class="glyphicon glyphicon-trash"></span></a>
                    </td>
                </tr>
            </table>
        </div>
    </section>

    <!-- About Section -->
    <section id="about">
        <div class="container">
            <div class="row">
                <div class="col-lg-10 col-lg-offset-1">
                    <p class="text-center">Copyright (c) 2018 Sumandeep Banerjee</p>
                </div>
            </div>
        </div>
    </section>
</div>